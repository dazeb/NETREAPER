#!/usr/bin/env bash
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# NETREAPER - Offensive Security Framework
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# Copyright (c) 2025 Nerds489
# SPDX-License-Identifier: Apache-2.0
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at:
#
#     http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#
# See LICENSE and NOTICE files in the project root for full details.
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
#
# Exploit module: Metasploit, SQLmap, Nikto, web attacks, exploit frameworks
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# Prevent multiple sourcing
[[ -n "${_NETREAPER_EXPLOIT_LOADED:-}" ]] && return 0
readonly _NETREAPER_EXPLOIT_LOADED=1

# Source library files
source "${BASH_SOURCE%/*}/../lib/core.sh"
source "${BASH_SOURCE%/*}/../lib/ui.sh"
source "${BASH_SOURCE%/*}/../lib/safety.sh"
source "${BASH_SOURCE%/*}/../lib/detection.sh"
source "${BASH_SOURCE%/*}/../lib/utils.sh"

#â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# METASPLOIT FUNCTIONS
#â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# Launch Metasploit console
run_metasploit() {
    check_tool "msfconsole" || return 1

    operation_header "Metasploit" "msfconsole"
    local start_time
    start_time=$(date +%s)

    log_command_preview "msfconsole"
    log_audit "EXPLOIT" "metasploit" "launch"

    msfconsole

    local duration
    duration=$(elapsed_time "$start_time")
    operation_summary "success" "Metasploit" "Duration: $duration"
}

# Launch Metasploit with resource script
# Args: $1 = resource script path
run_metasploit_rc() {
    local rc_file="$1"
    check_tool "msfconsole" || return 1

    if [[ -n "$rc_file" ]] && [[ ! -f "$rc_file" ]]; then
        log_error "Resource file not found: $rc_file"
        return 1
    fi

    operation_header "Metasploit RC" "$rc_file"
    log_command_preview "msfconsole -r $rc_file"
    log_audit "EXPLOIT" "metasploit_rc" "$rc_file"

    msfconsole -r "$rc_file"
}

# Run msfvenom payload generator
# Args: $1 = payload, $2 = lhost, $3 = lport, $4 = format, $5 = outfile
run_msfvenom() {
    local payload="${1:-windows/meterpreter/reverse_tcp}"
    local lhost="$2"
    local lport="${3:-4444}"
    local format="${4:-exe}"
    local outfile="$5"

    check_tool "msfvenom" || return 1

    if [[ -z "$lhost" ]]; then
        log_error "LHOST required"
        return 1
    fi

    [[ -z "$outfile" ]] && outfile="${LOOT_DIR:-/tmp}/payload_$(timestamp_filename).${format}"

    operation_header "MSFVenom" "$payload"
    log_command_preview "msfvenom -p $payload LHOST=$lhost LPORT=$lport -f $format -o $outfile"
    log_audit "EXPLOIT" "msfvenom" "$payload"

    msfvenom -p "$payload" LHOST="$lhost" LPORT="$lport" -f "$format" -o "$outfile"

    log_loot "Payload generated: $outfile"
}

#â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# SQLMAP FUNCTIONS
#â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# Run SQLmap against target URL
# Args: $1 = target URL
run_sqlmap() {
    local target="$1"
    check_tool "sqlmap" || return 1

    if [[ -z "$target" ]]; then
        log_error "Target URL required"
        return 1
    fi

    operation_header "SQLmap" "$target"
    local start_time
    start_time=$(date +%s)
    local outdir="${OUTPUT_DIR:-/tmp}/sqlmap_$(timestamp_filename)"

    log_command_preview "sqlmap -u $target --batch --output-dir=$outdir"
    log_audit "EXPLOIT" "sqlmap" "$target"

    sqlmap -u "$target" --batch --output-dir="$outdir"

    local duration
    duration=$(elapsed_time "$start_time")
    operation_summary "success" "SQLmap" "Output: $outdir\nDuration: $duration"
    log_loot "SQLmap results: $outdir"
}

# Run SQLmap with advanced options
# Args: $1 = target URL, $2 = additional options
run_sqlmap_advanced() {
    local target="$1"
    local options="${2:---dbs}"
    check_tool "sqlmap" || return 1

    if [[ -z "$target" ]]; then
        log_error "Target URL required"
        return 1
    fi

    operation_header "SQLmap Advanced" "$target"
    local start_time
    start_time=$(date +%s)
    local outdir="${OUTPUT_DIR:-/tmp}/sqlmap_$(timestamp_filename)"

    log_command_preview "sqlmap -u $target $options --batch --output-dir=$outdir"
    log_audit "EXPLOIT" "sqlmap_advanced" "$target"

    sqlmap -u "$target" $options --batch --output-dir="$outdir"

    local duration
    duration=$(elapsed_time "$start_time")
    operation_summary "success" "SQLmap" "Output: $outdir\nDuration: $duration"
    log_loot "SQLmap results: $outdir"
}

#â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# NIKTO FUNCTIONS
#â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# Run Nikto web scanner
# Args: $1 = target host/URL
run_nikto() {
    local target="$1"
    check_tool "nikto" || return 1
    validate_target "$target" || return 1

    operation_header "Nikto" "$target"
    local start_time
    start_time=$(date +%s)
    local outfile
    outfile=$(generate_target_filename "$target" "nikto" "txt")

    log_command_preview "nikto -h $target -o $outfile"
    log_audit "EXPLOIT" "nikto" "$target"

    nikto -h "$target" -o "$outfile"

    local duration
    duration=$(elapsed_time "$start_time")
    operation_summary "success" "Nikto" "Output: $outfile\nDuration: $duration"
    log_loot "Nikto results: $outfile"
}

#â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# GOBUSTER / DIRECTORY BRUTE FORCE
#â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# Run Gobuster directory brute force
# Args: $1 = target URL, $2 = wordlist (optional)
run_gobuster() {
    local target="$1"
    local wordlist="${2:-/usr/share/wordlists/dirb/common.txt}"

    check_tool "gobuster" || return 1
    validate_target "$target" || return 1

    if [[ ! -f "$wordlist" ]]; then
        log_error "Wordlist not found: $wordlist"
        return 1
    fi

    operation_header "Gobuster" "$target"
    local start_time
    start_time=$(date +%s)
    local outfile
    outfile=$(generate_target_filename "$target" "gobuster" "txt")

    log_command_preview "gobuster dir -u $target -w $wordlist -o $outfile"
    log_audit "EXPLOIT" "gobuster" "$target"

    gobuster dir -u "$target" -w "$wordlist" -o "$outfile"

    local duration
    duration=$(elapsed_time "$start_time")
    operation_summary "success" "Gobuster" "Output: $outfile\nDuration: $duration"
    log_loot "Gobuster results: $outfile"
}

# Run DIRB directory brute force
# Args: $1 = target URL, $2 = wordlist (optional)
run_dirb() {
    local target="$1"
    local wordlist="${2:-/usr/share/dirb/wordlists/common.txt}"

    check_tool "dirb" || return 1
    validate_target "$target" || return 1

    operation_header "DIRB" "$target"
    local start_time
    start_time=$(date +%s)
    local outfile
    outfile=$(generate_target_filename "$target" "dirb" "txt")

    log_command_preview "dirb $target $wordlist -o $outfile"
    log_audit "EXPLOIT" "dirb" "$target"

    dirb "$target" "$wordlist" -o "$outfile"

    local duration
    duration=$(elapsed_time "$start_time")
    operation_summary "success" "DIRB" "Output: $outfile\nDuration: $duration"
    log_loot "DIRB results: $outfile"
}

# Run Feroxbuster
# Args: $1 = target URL, $2 = wordlist (optional)
run_feroxbuster() {
    local target="$1"
    local wordlist="${2:-/usr/share/seclists/Discovery/Web-Content/raft-medium-directories.txt}"

    check_tool "feroxbuster" || return 1
    validate_target "$target" || return 1

    operation_header "Feroxbuster" "$target"
    local start_time
    start_time=$(date +%s)
    local outfile
    outfile=$(generate_target_filename "$target" "feroxbuster" "txt")

    log_command_preview "feroxbuster -u $target -w $wordlist -o $outfile"
    log_audit "EXPLOIT" "feroxbuster" "$target"

    feroxbuster -u "$target" -w "$wordlist" -o "$outfile"

    local duration
    duration=$(elapsed_time "$start_time")
    operation_summary "success" "Feroxbuster" "Output: $outfile\nDuration: $duration"
    log_loot "Feroxbuster results: $outfile"
}

#â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# NUCLEI FUNCTIONS
#â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# Run Nuclei vulnerability scanner
# Args: $1 = target
run_nuclei() {
    local target="$1"
    check_tool "nuclei" || return 1
    validate_target "$target" || return 1

    operation_header "Nuclei" "$target"
    local start_time
    start_time=$(date +%s)
    local outfile
    outfile=$(generate_target_filename "$target" "nuclei" "txt")

    log_command_preview "nuclei -u $target -o $outfile"
    log_audit "EXPLOIT" "nuclei" "$target"

    nuclei -u "$target" -o "$outfile"

    local duration
    duration=$(elapsed_time "$start_time")
    operation_summary "success" "Nuclei" "Output: $outfile\nDuration: $duration"
    log_loot "Nuclei results: $outfile"
}

#â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# SEARCHSPLOIT FUNCTIONS
#â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# Search ExploitDB
# Args: $1 = search term
run_searchsploit() {
    local term="$1"
    check_tool "searchsploit" || return 1

    if [[ -z "$term" ]]; then
        log_error "Search term required"
        return 1
    fi

    operation_header "Searchsploit" "$term"
    local start_time
    start_time=$(date +%s)

    log_command_preview "searchsploit $term"
    log_audit "EXPLOIT" "searchsploit" "$term"

    searchsploit "$term"

    local duration
    duration=$(elapsed_time "$start_time")
    operation_summary "success" "Searchsploit" "Duration: $duration"
}

#â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# XSS / INJECTION TOOLS
#â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# Run XSStrike XSS scanner
# Args: $1 = target URL
run_xsstrike() {
    local target="$1"
    check_tool "xsstrike" || return 1

    if [[ -z "$target" ]]; then
        log_error "Target URL required"
        return 1
    fi

    operation_header "XSStrike" "$target"
    local start_time
    start_time=$(date +%s)

    log_command_preview "xsstrike -u $target"
    log_audit "EXPLOIT" "xsstrike" "$target"

    xsstrike -u "$target"

    local duration
    duration=$(elapsed_time "$start_time")
    operation_summary "success" "XSStrike" "Duration: $duration"
}

# Run Commix command injection
# Args: $1 = target URL
run_commix() {
    local target="$1"
    check_tool "commix" || return 1

    if [[ -z "$target" ]]; then
        log_error "Target URL required"
        return 1
    fi

    operation_header "Commix" "$target"
    local start_time
    start_time=$(date +%s)

    log_command_preview "commix -u $target --batch"
    log_audit "EXPLOIT" "commix" "$target"

    commix -u "$target" --batch

    local duration
    duration=$(elapsed_time "$start_time")
    operation_summary "success" "Commix" "Duration: $duration"
}

#â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# EXPLOIT MENU
#â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# Interactive exploit menu
exploit_menu() {
    local target=""

    while true; do
        clear
        echo -e "    ${C_RED}â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—${C_RESET}"
        echo -e "    ${C_RED}â•‘${C_RESET}                     ${C_RED}ğŸ’€ EXPLOIT ARSENAL${C_RESET}                           ${C_RED}â•‘${C_RESET}"
        echo -e "    ${C_RED}â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£${C_RESET}"
        echo -e "    ${C_RED}â•‘${C_RESET}                                                                   ${C_RED}â•‘${C_RESET}"
        echo -e "    ${C_RED}â•‘${C_RESET}   ${C_SHADOW}â”€â”€â”€â”€ Frameworks â”€â”€â”€â”€${C_RESET}                                          ${C_RED}â•‘${C_RESET}"
        echo -e "    ${C_RED}â•‘${C_RESET}   ${C_GHOST}[1]${C_RESET} Metasploit Console     ${C_SHADOW}msfconsole${C_RESET}                      ${C_RED}â•‘${C_RESET}"
        echo -e "    ${C_RED}â•‘${C_RESET}   ${C_GHOST}[2]${C_RESET} MSFVenom Payload       ${C_SHADOW}generate payloads${C_RESET}               ${C_RED}â•‘${C_RESET}"
        echo -e "    ${C_RED}â•‘${C_RESET}   ${C_GHOST}[3]${C_RESET} Exploit Search         ${C_SHADOW}searchsploit${C_RESET}                    ${C_RED}â•‘${C_RESET}"
        echo -e "    ${C_RED}â•‘${C_RESET}                                                                   ${C_RED}â•‘${C_RESET}"
        echo -e "    ${C_RED}â•‘${C_RESET}   ${C_SHADOW}â”€â”€â”€â”€ Web Attacks â”€â”€â”€â”€${C_RESET}                                         ${C_RED}â•‘${C_RESET}"
        echo -e "    ${C_RED}â•‘${C_RESET}   ${C_GHOST}[4]${C_RESET} SQL Injection          ${C_SHADOW}sqlmap${C_RESET}                          ${C_RED}â•‘${C_RESET}"
        echo -e "    ${C_RED}â•‘${C_RESET}   ${C_GHOST}[5]${C_RESET} Web Scanner            ${C_SHADOW}nikto${C_RESET}                           ${C_RED}â•‘${C_RESET}"
        echo -e "    ${C_RED}â•‘${C_RESET}   ${C_GHOST}[6]${C_RESET} Vuln Scanner           ${C_SHADOW}nuclei${C_RESET}                          ${C_RED}â•‘${C_RESET}"
        echo -e "    ${C_RED}â•‘${C_RESET}   ${C_GHOST}[7]${C_RESET} XSS Scanner            ${C_SHADOW}xsstrike${C_RESET}                        ${C_RED}â•‘${C_RESET}"
        echo -e "    ${C_RED}â•‘${C_RESET}   ${C_GHOST}[8]${C_RESET} Command Injection      ${C_SHADOW}commix${C_RESET}                          ${C_RED}â•‘${C_RESET}"
        echo -e "    ${C_RED}â•‘${C_RESET}                                                                   ${C_RED}â•‘${C_RESET}"
        echo -e "    ${C_RED}â•‘${C_RESET}   ${C_SHADOW}â”€â”€â”€â”€ Directory Brute Force â”€â”€â”€â”€${C_RESET}                               ${C_RED}â•‘${C_RESET}"
        echo -e "    ${C_RED}â•‘${C_RESET}   ${C_GHOST}[9]${C_RESET} Gobuster               ${C_SHADOW}directory fuzzing${C_RESET}               ${C_RED}â•‘${C_RESET}"
        echo -e "    ${C_RED}â•‘${C_RESET}   ${C_GHOST}[10]${C_RESET} DIRB                  ${C_SHADOW}web content scanner${C_RESET}             ${C_RED}â•‘${C_RESET}"
        echo -e "    ${C_RED}â•‘${C_RESET}   ${C_GHOST}[11]${C_RESET} Feroxbuster           ${C_SHADOW}fast recursive scanner${C_RESET}          ${C_RED}â•‘${C_RESET}"
        echo -e "    ${C_RED}â•‘${C_RESET}                                                                   ${C_RED}â•‘${C_RESET}"
        echo -e "    ${C_RED}â•‘${C_RESET}                       ${C_RED}[B] â† Back${C_RESET}                                  ${C_RED}â•‘${C_RESET}"
        echo -e "    ${C_RED}â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•${C_RESET}"
        echo
        echo -ne "    ${C_CYAN}â–¶${C_RESET} "
        read -r choice

        case "$choice" in
            1)  # Metasploit
                run_metasploit
                ;;
            2)  # MSFVenom
                echo -ne "    ${C_CYAN}Payload [windows/meterpreter/reverse_tcp]: ${C_RESET}"
                read -r payload
                echo -ne "    ${C_CYAN}LHOST: ${C_RESET}"
                read -r lhost
                echo -ne "    ${C_CYAN}LPORT [4444]: ${C_RESET}"
                read -r lport
                echo -ne "    ${C_CYAN}Format [exe]: ${C_RESET}"
                read -r format
                run_msfvenom "${payload:-windows/meterpreter/reverse_tcp}" "$lhost" "${lport:-4444}" "${format:-exe}"
                ;;
            3)  # Searchsploit
                echo -ne "    ${C_CYAN}Search term: ${C_RESET}"
                read -r term
                run_searchsploit "$term"
                ;;
            4)  # SQLmap
                echo -ne "    ${C_CYAN}Target URL (with parameter): ${C_RESET}"
                read -r target
                run_sqlmap "$target"
                ;;
            5)  # Nikto
                echo -ne "    ${C_CYAN}Target host/URL: ${C_RESET}"
                read -r target
                run_nikto "$target"
                ;;
            6)  # Nuclei
                echo -ne "    ${C_CYAN}Target: ${C_RESET}"
                read -r target
                run_nuclei "$target"
                ;;
            7)  # XSStrike
                echo -ne "    ${C_CYAN}Target URL: ${C_RESET}"
                read -r target
                run_xsstrike "$target"
                ;;
            8)  # Commix
                echo -ne "    ${C_CYAN}Target URL: ${C_RESET}"
                read -r target
                run_commix "$target"
                ;;
            9)  # Gobuster
                echo -ne "    ${C_CYAN}Target URL: ${C_RESET}"
                read -r target
                run_gobuster "$target"
                ;;
            10) # DIRB
                echo -ne "    ${C_CYAN}Target URL: ${C_RESET}"
                read -r target
                run_dirb "$target"
                ;;
            11) # Feroxbuster
                echo -ne "    ${C_CYAN}Target URL: ${C_RESET}"
                read -r target
                run_feroxbuster "$target"
                ;;
            b|B|0)
                return
                ;;
            *)
                log_error "Invalid option"
                ;;
        esac
        echo -e "\n    ${C_SHADOW}Press Enter to continue...${C_RESET}"
        read -r
    done
}

#â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# EXPORT FUNCTIONS
#â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# Metasploit
export -f run_metasploit run_metasploit_rc run_msfvenom

# SQL Injection
export -f run_sqlmap run_sqlmap_advanced

# Web scanning
export -f run_nikto run_nuclei

# Directory brute force
export -f run_gobuster run_dirb run_feroxbuster

# Exploit search
export -f run_searchsploit

# XSS/Injection
export -f run_xsstrike run_commix

# Menu
export -f exploit_menu
